[TOC]



## 0. 参考文档

http://zhufengpeixun.com/strong/html/125.11.docker.html#t5516.%20%E6%95%B0%E6%8D%AE%E7%9B%98

## 1. 数据盘

- 删除容器的时候，容器层里创建的文件也会被删除掉，如果有些数据你想永久保存，比如Web服务器的日志，数据库管理系统中的数据，可以为容器创建一个数据盘




### 1.1 创建数据卷

```shell
docker volume --help # volume 帮助命令
docker volume create nginx-vol # 创建 名称为 nginx-vol 的数据卷 默认路径/var/lib/docker/volumes/nginx-vol/_data
docker volume ls # 查看所有数据卷
docker volume inspect nginx-vol# 查看nginx-vol数据卷的详情
```

## 1.2 同步数据卷

#### 1.2.1 默认数据卷

```shell
# 同步容器内 /usr/share/nginx/html 和宿主机/var/lib/docker/volumes/nginx-vol/_data 目录 使两者保持一致
# 两个目录里面的内容具有一致性,即任何一处的更改都会保持一致
docker run -d  --name=nginx1 --mount src=nginx-vol,dst=/usr/share/nginx/html nginx 
docker run -d  --name=nginx2  -v nginx-vol:/usr/share/nginx/html -p 3000:80 nginx
```

#### 1.2.2 指定数据卷

```shell
# 如果源文件/目录不存在，不会自动创建，会抛出一个错误
# 如果挂载目标在容器中非空目录，则该目录现有内容将被隐藏
# 可以存储在宿主机系统的任意位置
docker run -v /nginx-data:/usr/share/nginx/html -it --name logs nginx bash
```



### 1.3 删除数据卷

```shell
docker container stop nginx1 # 停止容器
docker container rm nginx1 # 删除容器
docker volume rm nginx-vol  # 删除数据库
docker volume ls -f dangling=true #列出已经孤立的数据盘
```

